version: 1
frontend:
  phases:
    preBuild:
      commands:
        - git submodule update --init --recursive
        - ZOLA_VERSION=$(python -c "import json, urllib.request; data=json.load(urllib.request.urlopen('https://api.github.com/repos/getzola/zola/releases/latest')); print(data['tag_name'])")
        - curl -sL "https://github.com/getzola/zola/releases/download/${ZOLA_VERSION}/zola-${ZOLA_VERSION}-x86_64-unknown-linux-musl.tar.gz" -o zola.tar.gz
        - tar -xzf zola.tar.gz
        - chmod +x zola
        - sudo mv zola /usr/local/bin/zola
        - zola --version
    build:
      commands:
        - zola build
  artifacts:
    baseDirectory: public
    files:
      - "**/*"
